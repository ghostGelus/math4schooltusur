(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53d676ec"],{"0a6c":function(t,e,a){},2341:function(t,e,a){"use strict";var s=a("0a6c"),n=a.n(s);n.a},"39d7":function(t,e,a){},5016:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("menu-tooltip",{staticClass:"select_button",class:{"select_button--touch":!t.touchDisabled},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}},[a("template",{slot:"button"},[t.options.length?a("div",{staticClass:"button button--thin_text",class:{"select_button__button--selected":t.menuOpen},on:{click:function(e){t.menuOpen=!0}}},[t._v(" "+t._s(t.options[t.selectedIndex].name)+" "),a("font-awesome-icon",{staticClass:"button__icon select_button__icon",attrs:{icon:["fa","chevron-down"],"fixed-width":""}})],1):a("div",{staticClass:"button"},[t._v(" No options ")])]),a("template",{slot:"menu"},t._l(t.options,(function(e,s){return a("div",{key:"select-button-option-"+e.name+s,staticClass:"select_button__option",class:{"select_button__option--disabled":e.disabled,"select_button__option--selected":s===t.selectedIndex&&!e.disabled},on:{click:function(a){return t.select(s,e.disabled)}}},[t._v(" "+t._s(e.name)+" ")])})),0)],2)},n=[],i=(a("4160"),a("159b"),a("6fab")),r={name:"SelectButton",props:["options","value","name","touch-disabled"],components:{MenuTooltip:i["a"]},methods:{select:function(t,e){e||(this.selectedIndex=t,this.menuOpen=!1,this.$emit("input",this.options[t].value))},getIndexFromValue:function(){var t=0,e=this;return null!==this.value&&this.options.forEach((function(a,s){a.value===e.value&&(t=s)})),t}},data:function(){return{selectedIndex:this.getIndexFromValue(),menuOpen:!1}},watch:{value:function(){this.selectedIndex=this.getIndexFromValue()}}},o=r,l=(a("2341"),a("2877")),c=Object(l["a"])(o,s,n,!1,null,"5c300c04",null);e["a"]=c.exports},"6e0b":function(t,e,a){"use strict";var s=a("39d7"),n=a.n(s);n.a},"6fab":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"menu_tooltip",class:{"menu_tooltip--touch":!t.touchDisabled}},[a("div",{staticClass:"menu_tooltip__overlay",class:{"menu_tooltip__overlay--show":t.value},on:{click:function(e){return t.$emit("input",!1)}}}),t._t("button"),a("div",{staticClass:"menu_tooltip__menu",class:{"menu_tooltip__menu--show":t.value},style:{top:t.top,width:t.width}},[a("div",{staticClass:"menu_tooltip__menu__inner"},[t._t("menu")],2)])],2)},n=[],i={name:"MenuTooltip",props:["value","top","width","touch-disabled"]},r=i,o=(a("6e0b"),a("2877")),l=Object(o["a"])(r,s,n,!1,null,"5bd61e2c",null);e["a"]=l.exports},"6fbc":function(t,e,a){"use strict";var s=a("e438"),n=a.n(s);n.a},"84a2":function(t,e,a){(function(e){var a="Expected a function",s=NaN,n="[object Symbol]",i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,d="object"==typeof e&&e&&e.Object===Object&&e,u="object"==typeof self&&self&&self.Object===Object&&self,h=d||u||Function("return this")(),_=Object.prototype,p=_.toString,f=Math.max,m=Math.min,v=function(){return h.Date.now()};function y(t,e,s){var n,i,r,o,l,c,d=0,u=!1,h=!1,_=!0;if("function"!=typeof t)throw new TypeError(a);function p(e){var a=n,s=i;return n=i=void 0,d=e,o=t.apply(s,a),o}function y(t){return d=t,l=setTimeout(w,e),u?p(t):o}function g(t){var a=t-c,s=t-d,n=e-a;return h?m(n,r-s):n}function C(t){var a=t-c,s=t-d;return void 0===c||a>=e||a<0||h&&s>=r}function w(){var t=v();if(C(t))return x(t);l=setTimeout(w,g(t))}function x(t){return l=void 0,_&&n?p(t):(n=i=void 0,o)}function $(){void 0!==l&&clearTimeout(l),d=0,n=c=i=l=void 0}function k(){return void 0===l?o:x(v())}function O(){var t=v(),a=C(t);if(n=arguments,i=this,c=t,a){if(void 0===l)return y(c);if(h)return l=setTimeout(w,e),p(c)}return void 0===l&&(l=setTimeout(w,e)),o}return e=T(e)||0,b(s)&&(u=!!s.leading,h="maxWait"in s,r=h?f(T(s.maxWait)||0,e):r,_="trailing"in s?!!s.trailing:_),O.cancel=$,O.flush=k,O}function g(t,e,s){var n=!0,i=!0;if("function"!=typeof t)throw new TypeError(a);return b(s)&&(n="leading"in s?!!s.leading:n,i="trailing"in s?!!s.trailing:i),y(t,e,{leading:n,maxWait:e,trailing:i})}function b(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function C(t){return!!t&&"object"==typeof t}function w(t){return"symbol"==typeof t||C(t)&&p.call(t)==n}function T(t){if("number"==typeof t)return t;if(w(t))return s;if(b(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=b(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var a=o.test(t);return a||l.test(t)?c(t.slice(2),a?2:8):r.test(t)?s:+t}t.exports=g}).call(this,a("c8ba"))},8628:function(t,e,a){},8674:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scroll_load"},[t._t("default")],2)},n=[],i=a("84a2"),r=a.n(i),o={name:"ScrollLoad",props:["loading","query-selector","padding-bottom","padding-top"],computed:{element:function(){return this.querySelector?document.querySelector(this.querySelector):null}},methods:{onScroll:r()((function(){var t,e,a=this.paddingBottom||300,s=this.paddingTop||150;this.loading||(this.element?(t=Math.floor(this.element.scrollTop+this.element.getBoundingClientRect().height+a-this.element.scrollHeight),e=s-this.element.scrollTop):(t=window.innerHeight+window.pageYOffset+a-document.body.scrollHeight,e=s-document.body.scrollTop),t>0?this.$emit("loadNext"):e>0&&this.$emit("loadPrevious"))}))},mounted:function(){(this.element||window).addEventListener("scroll",this.onScroll)},destroyed:function(){(this.element||window).removeEventListener("scroll",this.onScroll)}},l=o,c=a("2877"),d=Object(c["a"])(l,s,n,!1,null,null,null);e["a"]=d.exports},9870:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"thread_display_placeholder"},[a("div",{staticClass:"thread_display_placeholder__icon"}),a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"thread_display_placeholder__header"},[a("div",{staticClass:"thread_display_placeholder__bar thread_display_placeholder__bar--15"}),a("div",{staticClass:"thread_display_placeholder__bar thread_display_placeholder__bar--33"})]),a("div",{staticClass:"thread_display_placeholder__replies_bar"},[a("div",{staticClass:"thread_display_placeholder__bar thread_display_placeholder__bar--20"}),a("div",{staticClass:"thread_display_placeholder__bar thread_display_placeholder__bar--5"})]),a("div",{staticClass:"thread_display_placeholder__content"},[a("div",{staticClass:"thread_display_placeholder__bar"}),a("div",{staticClass:"thread_display_placeholder__bar thread_display_placeholder__bar--58"})])])])}],i={name:"ThreadDisplayPlaceholder"},r=i,o=(a("ad2c"),a("2877")),l=Object(o["a"])(r,s,n,!1,null,"3ef4b836",null);e["a"]=l.exports},"9c38":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("navbar"),a("div",{staticClass:"route_container"},[t.$store.state.meta.showDescription&&t.$store.state.meta.description?a("div",{staticClass:"forum_description"},[t._v(" "+t._s(t.$store.state.meta.description)+" ")]):t._e(),a("div",{staticClass:"thread_sorting"},[a("div",{staticClass:"thread_sorting__add_and_categories"},[a("select-button",{attrs:{options:t.categories},model:{value:t.selectedCategory,callback:function(e){t.selectedCategory=e},expression:"selectedCategory"}}),this.$store.state.username?a("router-link",{staticClass:"button button--blue",attrs:{to:"/thread/new"}},[t._v(" "+t._s(t.postNewThreadText)+" ")]):t._e()],1)]),a("div",{staticClass:"threads_main"},[a("div",{staticClass:"threads_main__side_bar"},[a("div",{staticClass:"threads_main__side_bar__title"},[t._v(" Категории ")]),t._l(t.categories,(function(e,s){return a("router-link",{key:"category-link-"+s,staticClass:"threads_main__side_bar__menu_item",class:{"threads_main__side_bar__menu_item--selected":e.value===t.selectedCategory},attrs:{to:"/category/"+e.value}},[a("span",{staticClass:"threads_main__side_bar__menu_item__border",style:{"background-color":e.color}}),a("span",{staticClass:"threads_main__side_bar__menu_item__text",style:{color:e.value===t.selectedCategory?e.color:void 0}},[t._v(t._s(e.name))])])}))],2),a("transition",{attrs:{name:"fade",mode:"out-in"}},[t.threads?t.filteredThreads.length?a("scroll-load",{key:"threads",staticClass:"threads_main__threads",attrs:{loading:t.loading},on:{loadNext:t.getThreads}},[t.loadingNewer?t._l(t.newThreads,(function(t){return a("thread-display-placeholder",{key:"placeholder-upper-"+t})})):t._e(),t.newThreads?a("div",{staticClass:"threads_main__load_new",on:{click:t.getNewerThreads}},[t._v(" Загрузите новые посты ")]):t._e(),t._l(t.filteredThreads,(function(t){return a("thread-display",{key:"thread-display-"+t.id,attrs:{thread:t}})})),t.loading?t._l(t.nextThreadsCount,(function(t){return a("thread-display-placeholder",{key:"placeholder-lower-"+t})})):t._e()],2):a("div",{key:"no threads",staticClass:"threads_main__threads overlay_message"},[a("font-awesome-icon",{attrs:{icon:["fa","exclamation-circle"]}}),t._v(" На форуме ничего нет. ")],1):a("div",{key:"loading",staticClass:"threads_main__threads"},[a("thread-display-placeholder")],1)],1)],1)])],1)},n=[],i=(a("4de4"),a("7db0"),a("4160"),a("d81d"),a("4e82"),a("0d03"),a("b0c0"),a("ac1f"),a("1276"),a("159b"),a("2909")),r=a("8674"),o=a("ce34"),l=a("9870"),c=a("5016"),d=a("c4b0"),u=a.n(d),h=a("bd28"),_=a("d178"),p=a("2fa3"),f={name:"index",components:{Navbar:_["a"],ScrollLoad:r["a"],ThreadDisplay:o["a"],ThreadDisplayPlaceholder:l["a"],SelectButton:c["a"]},data:function(){return{selectedFilterOption:"NEW",nextURL:"",nextThreadsCount:0,loading:!1,threads:null,newThreads:0,loadingNewer:!1}},computed:{filteredThreads:function(){var t=this,e={},a=this.selectedFilterOption;return this.$store.state.meta.categories.forEach((function(t){e[t.value]=t.name})),this.threads.filter((function(e){return e.Category.value===t.selectedCategory||"ALL"===t.selectedCategory})).map((function(t){var a=Object.assign({},t);return a.category=e[t.Category.value],a})).sort((function(t,e){if("NEW"===a){var s=new Date(t.Posts[0].createdAt),n=new Date(e.Posts[0].createdAt);return n-s}if("MOST_ACTIVE"===a)return e.postsCount-t.postsCount})).filter((function(t){return!("NO_REPLIES"===a&&t.postsCount-1)}))},categories:function(){return this.$store.getters.alphabetizedCategories},selectedCategory:{set:function(t){var e=this.categories.find((function(e){return e.value===t}));this.$store.dispatch("setTitle",e?e.name:""),this.$store.commit("setSelectedCategory",t)},get:function(){return this.$store.state.category.selectedCategory}},postNewThreadText:function(){return this.$store.state.username?"Опубликовать пост":"Авторизуйтесь"}},methods:{navigateToThread:function(t,e){this.$router.push("/thread/"+t+"/"+e)},getThreads:function(t){var e=this;if(null!==this.nextURL||t){var a=p["a"]+"/api/v1/category/"+this.selectedCategory;t||(a=this.nextURL||a),this.loading=!0,this.axios.get(a).then((function(a){var s;(e.loading=!1,t)?e.threads=a.data.Threads:(s=e.threads).push.apply(s,Object(i["a"])(a.data.Threads));e.nextURL=a.data.meta.nextURL,e.nextThreadsCount=a.data.meta.nextThreadsCount}))["catch"]((function(t){e.loading=!1,u()(e.$store)(t)}))}},getNewerThreads:function(){var t=this;this.loadingNewer=!0,this.axios.get(p["a"]+"/api/v1/category/"+this.selectedCategory+"?limit="+this.newThreads).then((function(e){var a;t.loadingNewer=!1,t.newThreads=0,(a=t.threads).unshift.apply(a,Object(i["a"])(e.data.Threads))}))["catch"]((function(e){t.loadingNewer=!1,u()(t.$store)(e)}))}},watch:{selectedCategory:function(t){this.$router.push("/category/"+t.toLowerCase())},$route:function(){this.selectedCategory=this.$route.path.split("/")[2].toUpperCase(),this.newThreads=0,this.getThreads(!0)}},created:function(){var t=this;this.selectedCategory=this.$route.path.split("/")[2].toUpperCase(),this.getThreads(!0),this.$socket.emit("join","index"),this.$socket.on("new thread",(function(e){e.value!==t.selectedCategory&&"ALL"!=t.selectedCategory||t.newThreads++})),this.$route.query.token&&(this.$store.commit("setToken",this.$route.query.token),this.$store.commit("setAccountTabs",0),this.$store.commit("setAccountModalState",!0)),Object(h["a"])("index")},destroyed:function(){this.$socket.emit("leave","index"),this.$socket.off("new thread")}},m=f,v=(a("af48"),a("2877")),y=Object(v["a"])(m,s,n,!1,null,"fa2bcc7a",null);e["default"]=y.exports},ad2c:function(t,e,a){"use strict";var s=a("b162"),n=a.n(s);n.a},af48:function(t,e,a){"use strict";var s=a("8628"),n=a.n(s);n.a},b162:function(t,e,a){},bd28:function(t,e,a){"use strict";var s=a("bc3a"),n=a.n(s),i=a("2fa3");e["a"]=function(t,e){"userPosts"===t||"userThreads"===t?n.a.get(i["a"]+"/api/v1/user/"+e).then((function(e){return n.a.post(i["a"]+"/api/v1/log",{route:t,resourceId:e.data.id})}))["catch"](console.log):n.a.post(i["a"]+"/api/v1/log",{route:t,resourceId:e})["catch"](console.log)}},ce34:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"thread_display"},[a("avatar-icon",{ref:"avatar",staticClass:"thread_display__icon",attrs:{user:t.thread.User,size:"small"},on:{click:t.goToUser}}),a("div",{staticStyle:{width:"calc(100% - 3rem)"},on:{click:t.goToThread}},[a("div",{staticClass:"thread_display__header"},[a("span",{staticClass:"thread_display__name"},[t._v(" "+t._s(t.thread.name)+" ")]),a("div",{staticClass:"thread_display__meta_bar"},[a("div",[t._v(" В категории "),a("span",{ref:"category",staticClass:"thread_display__category"},[t._v(t._s(t.thread.Category.name))])])])]),a("div",{staticClass:"thread_display__replies_bar"},[2===t.thread.Posts.length?a("div",{staticClass:"thread_display__latest_reply"}):a("span",{staticStyle:{cursor:"default"}}),a("div",{staticClass:"thread_display__replies",attrs:{title:"Replies to thread"}},[a("font-awesome-icon",{attrs:{icon:["far","comment"],"fixed-width":""}}),t._v(" "+t._s(t.thread.postsCount-1)+" ")],1)]),a("div",{staticClass:"thread_display__content"},[t._v(" "+t._s(t._f("truncate")(t._f("stripTags")(t.thread.Posts[0].content),150))+" ")])])],1)},n=[],i=a("9098"),r={name:"ThreadDisplay",props:["thread"],components:{AvatarIcon:i["a"]},computed:{threadUsername:function(){return this.thread.User?this.thread.User.username:"[deleted]"},replyUsername:function(){return this.thread.Posts[1].User?this.thread.Posts[1].User.username:"[deleted]"}},methods:{goToUser:function(){this.$router.push("/user/"+this.thread.User.username)},goToThread:function(){this.$router.push("/thread/"+this.thread.slug+"/"+this.thread.id)}}},o=r,l=(a("6fbc"),a("2877")),c=Object(l["a"])(o,s,n,!1,null,"4ff9b3b8",null);e["a"]=c.exports},e438:function(t,e,a){}}]);
//# sourceMappingURL=chunk-53d676ec.9dfab6e4.js.map