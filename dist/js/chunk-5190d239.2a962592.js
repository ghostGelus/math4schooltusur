(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5190d239"],{1840:function(t,e,o){},"23f8":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"moderation_header"},[o("h1",{staticClass:"moderation_header__h1"},[t._v("Модерация")]),o("div",{staticClass:"moderation_header__tabs"},[o("div",{staticClass:"tab_button",class:{"tab_button--selected":"bans"===t.selectedTab},on:{click:function(e){return t.$router.push("bans")}}},[t._v(" Блокировки ")]),o("div",{staticClass:"tab_button",class:{"tab_button--selected":"reports"===t.selectedTab},on:{click:function(e){return t.$router.push("reports")}}},[t._v(" Жалобы ")])])])},s=[],a={name:"ModerationHeader",props:["selected-tab"]},r=a,i=(o("4c3e"),o("2877")),l=Object(i["a"])(r,n,s,!1,null,"5e8c3ffe",null);e["a"]=l.exports},"39d7":function(t,e,o){},"3af9":function(t,e,o){},"3dc9":function(t,e,o){},"44ea":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"info_tooltip",on:{mouseenter:function(e){return t.setState(!0)},mouseleave:function(e){return t.setState(!1)}}},[o("div",{staticClass:"info_tooltip__content",class:{"info_tooltip__content--show":t.show,"info_tooltip__content--pointer_events":t.pointerEvents}},[t._t("content")],2),o("div",{staticClass:"info_tooltip__display",class:{"info_tooltip__display--hover":t.show}},[t._t("display")],2)])},s=[],a=(o("4795"),{name:"InfoTooltip",props:["noEvents"],data:function(){return{show:!1,pointerEvents:!1}},methods:{setState:function(t){var e=this;this.noEvents||(t?(this.pointerEvents=!0,this.show=!0,this.$emit("hover")):(this.show=!1,setTimeout((function(){e.show||(e.pointerEvents=!1)}),300)))}}}),r=a,i=(o("b067"),o("2877")),l=Object(i["a"])(r,n,s,!1,null,null,null);e["a"]=l.exports},4795:function(t,e,o){var n=o("23e7"),s=o("da84"),a=o("342f"),r=[].slice,i=/MSIE .\./.test(a),l=function(t){return function(e,o){var n=arguments.length>2,s=n?r.call(arguments,2):void 0;return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,s)}:e,o)}};n({global:!0,bind:!0,forced:i},{setTimeout:l(s.setTimeout),setInterval:l(s.setInterval)})},"4c3e":function(t,e,o){"use strict";var n=o("1840"),s=o.n(n);s.a},5573:function(t,e,o){"use strict";var n=o("796a"),s=o.n(n);s.a},"6e0b":function(t,e,o){"use strict";var n=o("39d7"),s=o.n(n);s.a},"6f58":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"overlay_message"},[o("span",{staticClass:"overlay_message__loading"},[o("loading-icon",{attrs:{dark:!0}})],1),t._v(" Загрузка... ")])},s=[],a=o("c5af"),r={name:"LoadingMessage",components:{LoadingIcon:a["a"]}},i=r,l=o("2877"),c=Object(l["a"])(i,n,s,!1,null,null,null);e["a"]=c.exports},"6fab":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"menu_tooltip",class:{"menu_tooltip--touch":!t.touchDisabled}},[o("div",{staticClass:"menu_tooltip__overlay",class:{"menu_tooltip__overlay--show":t.value},on:{click:function(e){return t.$emit("input",!1)}}}),t._t("button"),o("div",{staticClass:"menu_tooltip__menu",class:{"menu_tooltip__menu--show":t.value},style:{top:t.top,width:t.width}},[o("div",{staticClass:"menu_tooltip__menu__inner"},[t._t("menu")],2)])],2)},s=[],a={name:"MenuTooltip",props:["value","top","width","touch-disabled"]},r=a,i=(o("6e0b"),o("2877")),l=Object(i["a"])(r,n,s,!1,null,"5bd61e2c",null);e["a"]=l.exports},"796a":function(t,e,o){},"7d09":function(t,e,o){"use strict";var n=o("fd02"),s=o.n(n);s.a},8649:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"admin_moderation"},[o("moderation-header",{attrs:{"selected-tab":"reports"}}),o("confirm-modal",{attrs:{text:"Удалить",color:"red"},on:{confirm:t.removePost},model:{value:t.removePostObj.showConfirmModal,callback:function(e){t.$set(t.removePostObj,"showConfirmModal",e)},expression:"removePostObj.showConfirmModal"}},[t._v(" Вы действительно хотите удалить комментарий? ")]),o("confirm-modal",{attrs:{text:"Удалить",color:"red"},on:{confirm:t.deleteThread},model:{value:t.removePostObj.showThreadDeleteModal,callback:function(e){t.$set(t.removePostObj,"showThreadDeleteModal",e)},expression:"removePostObj.showThreadDeleteModal"}},[t._v(" Вы действительно хотите удалить пост?? ")]),o("transition",{attrs:{name:"fade",mode:"out-in"}},[t.reports?t.filteredReports.length?o("div",{key:"reports",staticClass:"admin_moderation__reports"},[o("div",{staticClass:"admin_moderation__report admin_moderation__report--header"},[o("div",{staticClass:"admin_moderation__report__post admin_moderation__report--cell_border admin_moderation__report--cell_border-hidden"},[t._v(" Человек и жалоба ")]),o("div",{staticClass:"admin_moderation__report__reason admin_moderation__report--cell_border admin_moderation__report--cell_border-hidden"},[t._v("Причина ")]),o("div",{staticClass:"admin_moderation__report__flagged_by admin_moderation__report--cell_border admin_moderation__report--cell_border-hidden"},[t._v(" Жалоба на пользователя ")]),o("div",{staticClass:"admin_moderation__report__actions"},[t._v(" Действия ")])]),t._l(t.filteredReports,(function(e,n){return o("div",{key:"report-"+n,staticClass:"admin_moderation__report"},[o("div",{staticClass:"admin_moderation__report__post admin_moderation__report--cell_border"},[o("div",{staticClass:"admin_moderation__report__post__header"},[o("avatar-icon",{staticClass:"admin_moderation__report__flagged_by__avatar",attrs:{size:"small",user:e.Post.User}}),o("div",[o("div",{staticClass:"admin_moderation__report__post__user"},[t._v(t._s(e.PostUserUsername))]),o("div",{staticClass:"admin_moderation__report__flagged_by__date"},[t._v("Posted "+t._s(t._f("formatDate")(e.createdAt)))])])],1),o("div",{staticClass:"admin_moderation__report__post__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(e.Post.content),150)))])]),o("div",{staticClass:"admin_moderation__report__reason admin_moderation__report--cell_border"},[t._v(t._s(e.reason))]),o("div",{staticClass:"admin_moderation__report__flagged_by admin_moderation__report--cell_border"},[o("avatar-icon",{staticClass:"admin_moderation__report__flagged_by__avatar",attrs:{size:"small",user:e.FlaggedByUser}}),o("div",{staticClass:"admin_moderation__report__flagged_by__text_info"},[o("div",{staticClass:"admin_moderation__report__flagged_by__user"},[t._v(t._s(e.FlaggedByUserUsername))]),o("div",{staticClass:"admin_moderation__report__flagged_by__date"},[t._v(t._s(t._f("formatDate")(e.createdAt)))])])],1),o("div",{staticClass:"admin_moderation__report__actions"},[o("button",{staticClass:"button button--red",on:{click:function(o){return t.removePost(e,n)}}},[t._v("Удалить")]),o("menu-button",{attrs:{options:t.reportMenuOptions},on:{delete:function(o){return t.deleteReport(e.id,n)},ban:function(o){return t.banUser(e,n)},deleteThread:function(o){return t.deleteThread(e,n)}}},[o("button",{staticClass:"button"},[t._v("Заблокировать…")])])],1)])}))],2):o("div",{key:"no reports",staticClass:"overlay_message"},[o("font-awesome-icon",{attrs:{icon:["fa","thumbs-up"]}}),t._v(" Нет жалоб ")],1):o("loading-message",{key:"loading"})],1)],1)},s=[],a=(o("4de4"),o("d81d"),o("a434"),o("b8bf"),o("4795"),o("96cf")),r=o("6f58"),i=o("9098"),l=o("da16"),c=o("23f8"),u=o("c4b0"),d=o.n(u),_=o("2fa3"),m={name:"AdminDashboard",components:{MenuButton:a["a"],LoadingMessage:r["a"],AvatarIcon:i["a"],ConfirmModal:l["a"],ModerationHeader:c["a"]},data:function(){return{reportMenuOptions:[{value:"Заблокировать пользователя",event:"ban"},{value:"Удалить пост",event:"deleteThread"}],reports:null,removePostObj:{showConfirmModal:!1,showThreadDeleteModal:!1,report:null,index:null}}},computed:{filteredReports:function(){return this.reports?this.reports.filter((function(t){return t.Post})).map((function(t){var e=Object.create(t);return t.Post.User?e.PostUserUsername=t.Post.User.username:e.PostUserUsername="[Deleted]",t.FlaggedByUser?e.FlaggedByUserUsername=t.FlaggedByUser.username:e.FlaggedByUserUsername="[Deleted]",e})):null}},methods:{deleteReport:function(t,e){var o=this;return this.axios.put(_["a"]+"/api/v1/report/"+t).then((function(){o.reports.splice(e,1)}))["catch"](d()(this.$store))},deleteThread:function(t,e){var o=this;if(t)this.removePostObj.report=t,this.removePostObj.index=e,this.removePostObj.showThreadDeleteModal=!0;else{var n=this.removePostObj.report.Post.Thread.id;this.axios.put(_["a"]+"/api/v1/thread/"+n).then((function(){o.reports=o.reports.filter((function(t){return t.Post.Thread.id!==n}))}))["catch"](d()(this.$store))}},removePost:function(t,e){var o=this;t?(this.removePostObj.report=t,this.removePostObj.index=e,this.removePostObj.showConfirmModal=!0):this.axios.put(_["a"]+"/api/v1/post/"+this.removePostObj.report.Post.id).then((function(){return o.axios.put(_["a"]+"/api/v1/report/"+o.removePostObj.report.id)})).then((function(){o.reports.splice(o.removePostObj.index,1)}))["catch"](d()(this.$store))},banUser:function(t){var e=this;this.$router.push("bans"),setTimeout((function(){e.$store.commit("moderation/setModal",!0),e.$store.commit("moderation/setUsername",t.Post.User.username)}),0)}},mounted:function(){var t=this;this.axios.get(_["a"]+"/api/v1/report").then((function(e){t.reports=e.data}))["catch"](d()(this.$store))}},p=m,v=(o("7d09"),o("2877")),f=Object(v["a"])(p,n,s,!1,null,"d2329828",null);e["default"]=f.exports},9098:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("info-tooltip",{staticClass:"avatar_icon",attrs:{noEvents:null===t.user}},[o("template",{slot:"content"},[t.userData?[o("div",{staticClass:"avatar_icon__header"},[o("div",{staticClass:"avatar_icon__icon avatar_icon__icon--small picture_circle",style:{"background-color":t.proxyUser.color,"background-image":t.pictureURL},on:{click:t.goToUser}},[t._v(" "+t._s(t.letter)+" ")]),o("div",{staticClass:"avatar_icon__header_info"},[o("span",{staticClass:"avatar_icon__username",on:{click:function(e){return e.stopPropagation(),t.goToUser(e)}}},[t._v(" "+t._s(t.proxyUser.username)+" "),t.proxyUser.admin?o("span",{staticClass:"admin_badge"},[t._v("администратор")]):t._e()])])])]:[t._v("Загрузка...")]],2),o("div",{staticClass:"avatar_icon__icon picture_circle",class:{"avatar_icon__icon--small":"small"===t.size,"avatar_icon__icon--tiny":"tiny"===t.size},style:{"background-color":t.proxyUser.color,"background-image":t.pictureURL},attrs:{slot:"display"},on:{click:function(e){return e.stopPropagation(),t.goToUser(e)}},slot:"display"},[t._v(" "+t._s(t.letter)+" ")])],2)},s=[],a=o("44ea"),r=o("c4b0"),i=o.n(r),l=o("2fa3"),c={name:"AvatarIcon",props:["user","size"],components:{InfoTooltip:a["a"]},data:function(){return{userData:null}},computed:{proxyUser:function(){return this.userData?this.userData:this.user?this.user:{}},letter:function(){return this.proxyUser.username&&!this.proxyUser.picture?this.proxyUser.username[0].toUpperCase():""},pictureURL:function(){return this.proxyUser.picture?"url("+this.proxyUser.picture+")":null}},methods:{loadUser:function(){var t=this;this.userData||null===this.user||this.axios.get(l["a"]+"/api/v1/user/"+this.proxyUser.username).then((function(e){t.userData=e.data}))["catch"](i()(this.$store))},goToUser:function(){null!==this.user&&this.$router.push("/user/"+this.user.username)}},mounted:function(){this.loadUser()}},u=c,d=(o("d465"),o("2877")),_=Object(d["a"])(u,n,s,!1,null,null,null);e["a"]=_.exports},"96cf":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("menu-tooltip",{staticClass:"menu_button",attrs:{top:"0",width:"10rem","touch-disabled":"true"},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}},[o("div",{staticClass:"menu_button__icon",attrs:{slot:"button"},on:{click:function(e){t.menuOpen=!0}},slot:"button"},[t._t("default")],2),o("template",{slot:"menu"},t._l(t.options,(function(e,n){return o("div",{key:"menu-button-option-"+e.value+"-"+n,staticClass:"menu_button__option",style:{"border-bottom":n===t.options.length-1?"none":"solid thin rgb(245, 245, 245)"},on:{click:function(o){return t.emit(e.event)}}},[t._v(" "+t._s(e.value)+" ")])})),0)],2)},s=[],a=o("6fab"),r={name:"MenuButton",props:["options"],components:{MenuTooltip:a["a"]},data:function(){return{menuOpen:!1}},methods:{emit:function(t){this.$emit(t),this.menuOpen=!1}}},i=r,l=(o("5573"),o("2877")),c=Object(l["a"])(i,n,s,!1,null,"5d9f8334",null);e["a"]=c.exports},b067:function(t,e,o){"use strict";var n=o("3af9"),s=o.n(n);s.a},b8bf:function(t,e,o){var n=o("23e7"),s=o("83ab"),a=o("7c73");n({target:"Object",stat:!0,sham:!s},{create:a})},d465:function(t,e,o){"use strict";var n=o("3dc9"),s=o.n(n);s.a},da16:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("modal-window",{attrs:{value:t.showModal},on:{input:t.setShowModal}},[o("div",{staticStyle:{"padding-top":"1rem"},attrs:{slot:"main"},slot:"main"},[t._t("default")],2),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("button",{staticClass:"button button--modal",class:t.buttonColor,on:{click:t.confirm}},[t._v(t._s(t.text||"OK"))]),o("button",{staticClass:"button button--modal",on:{click:function(e){return t.setShowModal(!1)}}},[t._v("Отмена")])])])},s=[],a=o("6307"),r={name:"ConfirmModal",props:["value","color","text"],components:{ModalWindow:a["a"]},data:function(){return{showModal:!1}},computed:{buttonColor:function(){return this.color?"button--"+this.color:""}},watch:{value:function(t){this.showModal=t}},methods:{setShowModal:function(t){this.showModal=t,this.$emit("input",t)},confirm:function(){this.$emit("confirm"),this.setShowModal(!1)}},mounted:function(){this.setShowModal(this.value)}},i=r,l=o("2877"),c=Object(l["a"])(i,n,s,!1,null,null,null);e["a"]=c.exports},fd02:function(t,e,o){}}]);
//# sourceMappingURL=chunk-5190d239.2a962592.js.map