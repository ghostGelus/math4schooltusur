(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a082552"],{"0a6c":function(t,e,n){},1840:function(t,e,n){},"225f":function(t,e,n){"use strict";var a=n("63a4"),o=n.n(a);o.a},2341:function(t,e,n){"use strict";var a=n("0a6c"),o=n.n(a);o.a},"23f8":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"moderation_header"},[n("h1",{staticClass:"moderation_header__h1"},[t._v("Модерация")]),n("div",{staticClass:"moderation_header__tabs"},[n("div",{staticClass:"tab_button",class:{"tab_button--selected":"bans"===t.selectedTab},on:{click:function(e){return t.$router.push("bans")}}},[t._v(" Блокировки ")]),n("div",{staticClass:"tab_button",class:{"tab_button--selected":"reports"===t.selectedTab},on:{click:function(e){return t.$router.push("reports")}}},[t._v(" Жалобы ")])])])},o=[],s={name:"ModerationHeader",props:["selected-tab"]},i=s,r=(n("4c3e"),n("2877")),c=Object(r["a"])(i,a,o,!1,null,"5e8c3ffe",null);e["a"]=c.exports},"39d7":function(t,e,n){},4795:function(t,e,n){var a=n("23e7"),o=n("da84"),s=n("342f"),i=[].slice,r=/MSIE .\./.test(s),c=function(t){return function(e,n){var a=arguments.length>2,o=a?i.call(arguments,2):void 0;return t(a?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,n)}};a({global:!0,bind:!0,forced:r},{setTimeout:c(o.setTimeout),setInterval:c(o.setInterval)})},"4c3e":function(t,e,n){"use strict";var a=n("1840"),o=n.n(a);o.a},5016:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("menu-tooltip",{staticClass:"select_button",class:{"select_button--touch":!t.touchDisabled},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}},[n("template",{slot:"button"},[t.options.length?n("div",{staticClass:"button button--thin_text",class:{"select_button__button--selected":t.menuOpen},on:{click:function(e){t.menuOpen=!0}}},[t._v(" "+t._s(t.options[t.selectedIndex].name)+" "),n("font-awesome-icon",{staticClass:"button__icon select_button__icon",attrs:{icon:["fa","chevron-down"],"fixed-width":""}})],1):n("div",{staticClass:"button"},[t._v(" No options ")])]),n("template",{slot:"menu"},t._l(t.options,(function(e,a){return n("div",{key:"select-button-option-"+e.name+a,staticClass:"select_button__option",class:{"select_button__option--disabled":e.disabled,"select_button__option--selected":a===t.selectedIndex&&!e.disabled},on:{click:function(n){return t.select(a,e.disabled)}}},[t._v(" "+t._s(e.name)+" ")])})),0)],2)},o=[],s=(n("4160"),n("159b"),n("6fab")),i={name:"SelectButton",props:["options","value","name","touch-disabled"],components:{MenuTooltip:s["a"]},methods:{select:function(t,e){e||(this.selectedIndex=t,this.menuOpen=!1,this.$emit("input",this.options[t].value))},getIndexFromValue:function(){var t=0,e=this;return null!==this.value&&this.options.forEach((function(n,a){n.value===e.value&&(t=a)})),t}},data:function(){return{selectedIndex:this.getIndexFromValue(),menuOpen:!1}},watch:{value:function(){this.selectedIndex=this.getIndexFromValue()}}},r=i,c=(n("2341"),n("2877")),l=Object(c["a"])(r,a,o,!1,null,"5c300c04",null);e["a"]=l.exports},"63a4":function(t,e,n){},"6e0b":function(t,e,n){"use strict";var a=n("39d7"),o=n.n(a);o.a},"6f58":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"overlay_message"},[n("span",{staticClass:"overlay_message__loading"},[n("loading-icon",{attrs:{dark:!0}})],1),t._v(" Загрузка... ")])},o=[],s=n("c5af"),i={name:"LoadingMessage",components:{LoadingIcon:s["a"]}},r=i,c=n("2877"),l=Object(c["a"])(r,a,o,!1,null,null,null);e["a"]=l.exports},"6fab":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu_tooltip",class:{"menu_tooltip--touch":!t.touchDisabled}},[n("div",{staticClass:"menu_tooltip__overlay",class:{"menu_tooltip__overlay--show":t.value},on:{click:function(e){return t.$emit("input",!1)}}}),t._t("button"),n("div",{staticClass:"menu_tooltip__menu",class:{"menu_tooltip__menu--show":t.value},style:{top:t.top,width:t.width}},[n("div",{staticClass:"menu_tooltip__menu__inner"},[t._t("menu")],2)])],2)},o=[],s={name:"MenuTooltip",props:["value","top","width","touch-disabled"]},i=s,r=(n("6e0b"),n("2877")),c=Object(r["a"])(i,a,o,!1,null,"5bd61e2c",null);e["a"]=c.exports},"80e3":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fancy_input",style:{width:t.width||"auto"}},[n("div",{staticStyle:{position:"relative",display:"inline-block"}},[n("div",{staticClass:"fancy_input__placeholder",class:{"fancy_input__placeholder--active":t.active||t.value.length,"fancy_input__placeholder--large":t.large}},[t._v(" "+t._s(t.placeholder)+" ")]),n("input",{staticClass:"fancy_input__input input",class:{"fancy_input__input--large":t.large,"fancy_input__input--error":t.error},attrs:{type:t.type||"text"},domProps:{value:t.value},on:{input:function(e){return t.updateValue(e.target.value)},focus:t.addActive,blur:t.removeActive}})]),n("error-tooltip",{attrs:{error:t.error}})],1)},o=[],s=n("e145"),i={name:"FancyInput",props:["value","placeholder","width","type","error","large"],components:{ErrorTooltip:s["a"]},data:function(){return{active:!1}},methods:{updateValue:function(t){this.$emit("input",t)},addActive:function(){this.active=!0},removeActive:function(){this.active=!1}}},r=i,c=(n("9946"),n("2877")),l=Object(c["a"])(r,a,o,!1,null,"e8a0c810",null);e["a"]=l.exports},8271:function(t,e,n){},"97bd":function(t,e,n){"use strict";var a=n("8271"),o=n.n(a);o.a},9946:function(t,e,n){"use strict";var a=n("bcc7"),o=n.n(a);o.a},a157:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"admin_moderation"},[n("div",{staticClass:"admin_moderation__header"},[n("moderation-header",{attrs:{"selected-tab":"bans"}}),n("button",{staticClass:"button button--blue",on:{click:t.toggleShowAddNewBanModal}},[t._v("Забанить пользователя")])],1),n("transition",{attrs:{name:"fade",mode:"out-in"}},[t.bans?t.bans.length?n("table",{key:"bans",staticClass:"admin_moderation__table"},[n("tr",[n("th",[t._v("Пользователь")]),n("th",[t._v("Тип блокировки")]),n("th",[t._v("Дата блокировки")]),n("th",[t._v("Сообщение")]),n("th",[t._v("Действие")])]),t._l(t.bans,(function(e,a){return n("tr",{key:"ban-row-"+a},[n("td",[t._v(t._s(e.User.username))]),n("td",[t._v(t._s(e.type))]),n("td",[t._v(t._s(t._f("formatDate")(e.createdAt)))]),n("td",[e.message?[t._v(t._s(e.message))]:n("i")],2),n("td",[n("button",{staticClass:"button button--red",on:{click:function(n){return t.deleteBan(e,a)}}},[t._v(" Убрать блокировку ")])])])}))],2):n("div",{key:"no bans",staticClass:"overlay_message"},[n("font-awesome-icon",{attrs:{icon:["fa","thumbs-up"]}}),t._v(" Нет заблокированных пользователей ")],1):n("loading-message",{key:"loading"})],1),n("modal-window",{attrs:{width:"30rem","no-padding":!0},model:{value:t.$store.state.moderation.showAddNewBanModal,callback:function(e){t.$set(t.$store.state.moderation,"showAddNewBanModal",e)},expression:"$store.state.moderation.showAddNewBanModal"}},[n("div",{staticClass:"admin_moderation__add_new_ban_modal",attrs:{slot:"main"},slot:"main"},[n("div",{staticClass:"admin_moderation__add_new_ban_modal__overlay",class:{"admin_moderation__add_new_ban_modal__overlay--show":t.loading}},[n("loading-icon")],1),n("h2",[t._v("Блокировка пользователя")]),n("p",[t._v("Найдите пользователя и выберите причину блокировки")]),n("form",{on:{submit:function(e){return e.preventDefault(),t.addBan(e)}}},[n("div",[n("fancy-input",{attrs:{placeholder:"Логин для блокировки",width:"15rem",large:!0},model:{value:t.$store.state.moderation.username,callback:function(e){t.$set(t.$store.state.moderation,"username",e)},expression:"$store.state.moderation.username"}})],1),n("div",[n("fancy-input",{attrs:{placeholder:"Сообщения для пользователя",width:"15rem",large:!0},model:{value:t.$store.state.moderation.message,callback:function(e){t.$set(t.$store.state.moderation,"message",e)},expression:"$store.state.moderation.message"}})],1),n("div",[n("select-button",{attrs:{options:t.$store.state.moderation.options,name:"test"},model:{value:t.$store.state.moderation.selectedOption,callback:function(e){t.$set(t.$store.state.moderation,"selectedOption",e)},expression:"$store.state.moderation.selectedOption"}})],1),n("input",{staticStyle:{display:"none"},attrs:{type:"submit"}})])]),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("button",{staticClass:"button button--modal button--green",on:{click:t.addBan}},[t._v(" Заблокировать ")]),n("button",{staticClass:"button button--modal",on:{click:t.toggleShowAddNewBanModal}},[t._v(" Отмена ")])])])],1)},o=[],s=(n("d81d"),n("a434"),n("498a"),n("6307")),i=n("80e3"),r=n("5016"),c=n("23f8"),l=n("c5af"),u=n("6f58"),d=n("c4b0"),_=n.n(d),p=n("2fa3"),m={name:"AdminDashboard",components:{ModalWindow:s["a"],FancyInput:i["a"],SelectButton:r["a"],ModerationHeader:c["a"],LoadingIcon:l["a"],LoadingMessage:u["a"]},data:function(){return{loading:!1,bans_:null}},computed:{bans:function(){return this.bans_?this.bans_.map((function(t){return t.ipBanned?t.type="Бан по Ip":t.canCreateThreads&&!t.canCreatePosts?t.type="Запретить комментировать":t.canCreatePosts&&!t.canCreateThreads?t.type="Запретить создавать темы":t.type="Запретить комментировать и создавать темы",t})):null}},methods:{toggleShowAddNewBanModal:function(){this.$store.commit("moderation/setModal",!this.$store.state.moderation.showAddNewBanModal),this.$store.dispatch("moderation/clearModal")},addBan:function(){var t=this,e=this.$store.state.moderation,n={username:e.username};e.message.trim().length&&(n.message=e.message),"both"===e.selectedOption?(n.canCreatePosts=!1,n.canCreateThreads=!1):"thread"===e.selectedOption?n.canCreateThreads=!1:"post"===e.selectedOption?n.canCreatePosts=!1:n.ipBanned=!0,this.loading=!0,this.axios.post(p["a"]+"/api/v1/ban",n).then((function(e){t.loading=!1,t.bans_.push(e.data),t.toggleShowAddNewBanModal(),t.$store.dispatch("moderation/clearModal")}))["catch"]((function(e){t.loading=!1,_()(t.$store)(e)}))},deleteBan:function(t,e){var n=this;this.axios.put(p["a"]+"/api/v1/ban/"+t.id).then((function(){n.bans_.splice(e,1)}))["catch"](_()(this.$store))}},mounted:function(){var t=this;this.axios.get(p["a"]+"/api/v1/ban").then((function(e){t.bans_=e.data}))["catch"](_()(this.$store))}},v=m,h=(n("97bd"),n("2877")),f=Object(h["a"])(v,a,o,!1,null,"5f30dc64",null);e["default"]=f.exports},bcc7:function(t,e,n){},e145:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"error_tooltip",class:{"error_tooltip--show":t.error}},[t._v(" "+t._s(t.delayed_error)+" ")])},o=[],s=(n("4795"),{name:"ErrorTooltip",props:["error"],data:function(){return{delayed_error:this.error}},watch:{error:function(t){var e=this;t?this.delayed_error=t:setTimeout((function(){e.delayed_error=""}),205)}}}),i=s,r=(n("225f"),n("2877")),c=Object(r["a"])(i,a,o,!1,null,"6281f96c",null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-6a082552.8a6dee74.js.map